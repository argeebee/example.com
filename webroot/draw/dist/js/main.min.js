var draw=function(){var e=document.querySelector("main"),t=e.offsetWidth,r=e.offsetHeight,n=document.createElement("canvas"),i=n.getContext("2d"),o=n.getBoundingClientRect(),s=0,a=0,l=0,c=0,d=0,h=0,u=!1,y=!1,f="",m=!1,w=[];return{setIsDrawing:function(e){m=e},getIsDrawing:function(){return m},getShape:function(){return f},setShape:function(e){f=e},randColor:function(){return"#"+Math.floor(16777215*Math.random()).toString(16)},setStart:function(){l=s,c=a},setEnd:function(){d=s,h=a},setXY:function(e){u=s,y=a,s=e.clientX-o.left-n.offsetLeft,a=e.clientY-o.top-n.offsetTop},writeXY:function(){document.getElementById("trackX").innerHTML="X: "+s,document.getElementById("trackY").innerHTML="Y: "+a},draw:function(){switch(i.restore(),f){case"rectangle":this.drawRect();break;case"line":this.drawLine();break;case"circle":this.drawCircle();break;case"triangle":this.drawTriangle();break;case"path":this.drawPath()}i.save()},drawCircle:function(){i.strokeStyle=this.randColor(),i.fillStyle=this.randColor();var e=l-d,t=c-h,r=Math.sqrt(e*e+t*t);i.beginPath(),i.arc(l,c,r,0,2*Math.PI),i.stroke(),i.fill(),w.push({shape:"circle",coords:{x1:l,y1:c,x2:d,y2:h},styles:{stroke:i.strokeStyle,fill:i.fillStyle}})},drawTriangle:function(){var e=l-d,t=c-h,r=Math.sqrt(e*e+t*t),n=l+r,o=c+r;d<l&&(n=l-r),h<c&&(o=c-r),i.fillStyle=this.randColor(),i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(l,c),i.lineTo(n,o),i.lineTo(d,h),i.lineTo(l,c),i.stroke(),i.fill(),w.push({shape:"triangle",coords:{x1:l,y1:c,x2:d,y2:h},styles:{stroke:i.strokeStyle,fill:i.fillStyle}})},drawPath:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(u,y),i.lineTo(s,a),i.stroke(),w.push({shape:"path",coords:{lx:u,ly:y,x:s,y:a},styles:{stroke:i.strokestyle}})},drawLine:function(){i.strokeStyle=this.randColor(),i.beginPath(),i.moveTo(l,c),i.lineTo(d,h),i.stroke(),w.push({shape:"line",coords:{x1:l,y1:l,x2:d,y2:h},styles:{stroke:i.strokestyle}})},drawRect:function(){i.fillStyle=this.randColor(),i.fillRect(l,c,d-l,h-c),i.strokeStyle=this.randColor(),i.strokeRect(l,c,d-l,h-c),w.push({shape:"rectangle",coords:{x1:l,y1:c,x2:d,y2:h},styles:{stroke:i.randColor,fill:i.randColor}})},clear:function(){n.width=n.width},redraw:function(){for(item in w){switch(f){case"path":f=w[item].shape,u=w[item].coords.lx,y=w[item].coords.ly,s=w[item].coords.x,a=w[item].coords.y,i.strokeStyle=w[item].styles.stroke;break;case"circle":f=w[item].shape,l=w[item].coords.x1,c=w[item].coords.y1,d=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke,i.fillStyle=w[item].styles.fill;break;case"line":f=w[item].shape,l=w[item].coords.x1,c=w[item].coords.y1,d=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke;break;case"rectangle":case"triangle":f=w[item].shape,l=w[item].coords.x1,c=w[item].coords.y1,d=w[item].coords.x2,h=w[item].coords.y2,i.strokeStyle=w[item].styles.stroke,i.fillStyle=w[item].styles.fill}this.draw()}},getCanvas:function(){return n},init:function(){n.width=t,n.height=r,e.appendChild(n)}}}();draw.init(),document.getElementById("btnRect").addEventListener("click",function(){draw.setShape("rectangle")}),document.getElementById("btnTri").addEventListener("click",function(){draw.setShape("triangle")}),document.getElementById("btnLine").addEventListener("click",function(){draw.setShape("line")}),document.getElementById("btnCircle").addEventListener("click",function(){draw.setShape("circle")}),document.getElementById("btnPath").addEventListener("click",function(){draw.setShape("path")}),document.getElementById("btnClear").addEventListener("click",function(){confirm("Are you sure you want to clear the canvas?")&&draw.clear()}),document.getElementById("btnRedraw").addEventListener("click",function(){confirm("Are you sure you want to redraw the canvas?")&&draw.redraw()}),draw.getCanvas().addEventListener("mousedown",function(){draw.setStart(),draw.setIsDrawing(!0)}),draw.getCanvas().addEventListener("mouseup",function(){draw.setEnd(),draw.draw(),draw.setIsDrawing(!1)}),draw.getCanvas().addEventListener("mousemove",function(e){draw.setXY(e),draw.writeXY(),"path"===draw.getShape()&&!0===draw.getIsDrawing()&&draw.draw()});